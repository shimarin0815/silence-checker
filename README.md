# 無音時間 計算機（Single‑File SPA）

ドラッグ＆ドロップした **MP3/WAV** の中から、**無音（設定したしきい値以下）** を **Web Audio API** で検出し、**合計時間** を表示します。処理は **すべてブラウザ内** で完結します。

---

## 特長

* ✅ 単一 `index.html` だけで動作（ビルド不要・依存無し）
* ✅ MP3/WAV 対応、ローカル解析で **アップロードなし**
* ✅ しきい値・フレームサイズ・最小連続無音を調整可能
* ✅ ファイル長／無音合計／無音割合／最長無音 を表示

---

## 必要環境

* 最新のモダンブラウザ（Chrome / Edge / Firefox / Safari など）
* オフラインでも可（`index.html` を開くだけ）

---

## 使い方（クイック）

1. このリポジトリ（または配布ファイル）の **`index.html`** を開く

   * VS Code の場合は拡張 **Live Server** で起動してもOK
2. 画面のドロップ領域に **MP3/WAV** をドラッグ＆ドロップ
3. 右側の **設定** でしきい値などを調整し、結果を確認

> ヒント：最初は **RMSしきい値 = 0.02**、**最小連続無音 = 0.10s** がおすすめです。

---

## 設定項目

* **しきい値（RMS）**

  * コマ（フレーム）ごとの平均音量（RMS）がこの値以下なら「無音」と判定
  * 小さいほど“厳しく静か”の判定になります（例：0.01〜0.05）
* **フレームサイズ（サンプル数）**

  * 解析の粒度。大きいほど粗く・速く、小さいほど細かく・遅く
  * 例：2048（初期値）／4096／8192
* **最小連続無音時間（秒）**

  * ここで指定した時間より短い“つぶつぶ無音”は無視します

---

## 画面の見方（出力）

* **ファイル長**：音声の全体長さ
* **無音合計**：無音と判定された部分の合計時間（主指標）
* **無音割合**：ファイル長に対する無音合計の割合（％）
* **最長無音**：最も長く連続した無音区間の長さ
* **波形プレビュー**：全体の振幅の目安（解析はRMSベースで実行）

---

## 仕組み（ざっくり）

1. Web Audio API で音声を **デコード** し、サンプル列（波形）を取得
2. 音声を **フレーム**（一定サンプル数）に分割
3. 各フレームの **RMS**（平均的な音量）を計算
4. **RMS ≤ しきい値** のフレームを「無音」とみなし、
5. **連続した無音** のみ合計（設定の「最小連続無音時間」未満は除外）

---

## サンプル音源（任意）

* 無音を含むテスト用MP3がある場合は、`sample_silence_pattern.mp3` をドロップして動作確認できます。
* ない場合は、任意の音声でもOKです（環境ノイズが少ないほど試しやすい）。

---

## よくある質問（FAQ）

**Q. 何を基準に値を決めればいい？**
A. まずは **RMS=0.02** / **最小連続無音=0.10s**。
十分に静かな素材→ 0.01 付近、BGMや環境ノイズが強い→ 0.03〜0.05 を目安に調整してください。

**Q. 重い／遅いときは？**
A. **フレームサイズ**を大きく（例：4096〜8192）すると速くなります。長時間音源は少し待ってね。

**Q. オンラインにアップロードされる？**
A. されません。**すべてブラウザ内**で解析します。

---

## 制限事項・注意

* MP3特有の圧縮ノイズなどで、完全な無音でも微小な値が出ることがあります → その場合は **しきい値** を少し上げてください。
* 解析はモノラル相当にミックスして行います（ステレオ差分の“位相打ち消し”などは考慮しません）。
* 解析はフレーム単位のRMSで行うため、非常に短い瞬間的な無音は設定によって無視される場合があります。

---

## 開発メモ

* 単一 **`index.html`**（HTML/CSS/JS）で完結、ライブラリ依存なし
* Web Audio API: `decodeAudioData` でデコード → フレームRMSで無音判定
* 改良案：

  * 無音区間リストの **CSVエクスポート**
  * **しきい値の自動推定**（ノイズフロア推定）
  * **オーバーラップ**ありのRMS計算（精度向上）

---
